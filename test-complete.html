<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>üß™ –ü–æ–ª–Ω—ã–π —Ç–µ—Å—Ç –§–µ–Ω–∏–∫—Å-–ü–æ–∏—Å–∫–∞</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: white;
            padding: 30px;
            line-height: 1.6;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: rgba(255,255,255,0.05);
            padding: 30px;
            border-radius: 20px;
            border: 2px solid #ff6b35;
        }
        h1 {
            text-align: center;
            color: #ffd166;
            margin-bottom: 30px;
        }
        .test-section {
            background: rgba(26,26,46,0.8);
            padding: 25px;
            border-radius: 15px;
            margin: 20px 0;
            border-left: 4px solid #3498db;
        }
        .test-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }
        .test-icon {
            font-size: 2rem;
        }
        button {
            background: linear-gradient(45deg, #ff6b35, #ff8e53);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 10px;
            cursor: pointer;
            font-weight: bold;
            margin: 10px 5px;
            transition: transform 0.3s ease;
        }
        button:hover {
            transform: translateY(-3px);
        }
        .result {
            margin-top: 15px;
            padding: 15px;
            background: rgba(0,0,0,0.3);
            border-radius: 10px;
            font-family: monospace;
            white-space: pre-wrap;
            max-height: 300px;
            overflow-y: auto;
        }
        .success { color: #2ecc71; border-left: 4px solid #2ecc71; }
        .error { color: #e74c3c; border-left: 4px solid #e74c3c; }
        .loading { color: #f1c40f; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üß™ –ü–û–õ–ù–´–ô –¢–ï–°–¢ –°–ò–°–¢–ï–ú–´ –§–ï–ù–ò–ö–°-–ü–û–ò–°–ö</h1>
        
        <!-- –¢–ï–°–¢ 1: API SEARCH -->
        <div class="test-section">
            <div class="test-header">
                <div class="test-icon">üîç</div>
                <h2>–¢–µ—Å—Ç 1: API –ü–æ–∏—Å–∫–∞</h2>
            </div>
            <p>–ü—Ä–æ–≤–µ—Ä—è–µ–º –æ—Å–Ω–æ–≤–Ω–æ–π API –ø–æ–∏—Å–∫–∞ —Å –∫–æ–ª–ª–µ–∫—Ç–∏–≤–Ω–æ–π –º—É–¥—Ä–æ—Å—Ç—å—é</p>
            <button onclick="testSearchAPI()">–ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç</button>
            <div id="result1" class="result">–ù–∞–∂–º–∏ –∫–Ω–æ–ø–∫—É –¥–ª—è —Ç–µ—Å—Ç–∞...</div>
        </div>
        
        <!-- –¢–ï–°–¢ 2: API QUESTIONS -->
        <div class="test-section">
            <div class="test-header">
                <div class="test-icon">üåç</div>
                <h2>–¢–µ—Å—Ç 2: API –ö–æ–ª–ª–µ–∫—Ç–∏–≤–Ω—ã—Ö –í–æ–ø—Ä–æ—Å–æ–≤</h2>
            </div>
            <p>–ü—Ä–æ–≤–µ—Ä—è–µ–º –±–∞–∑—É –∫–æ–ª–ª–µ–∫—Ç–∏–≤–Ω—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤</p>
            <button onclick="testQuestionsAPI()">–ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç</button>
            <div id="result2" class="result">–ù–∞–∂–º–∏ –∫–Ω–æ–ø–∫—É –¥–ª—è —Ç–µ—Å—Ç–∞...</div>
        </div>
        
        <!-- –¢–ï–°–¢ 3: –ö–õ–ê–°–° PhoenixSearch -->
        <div class="test-section">
            <div class="test-header">
                <div class="test-icon">ü¶Ö</div>
                <h2>–¢–µ—Å—Ç 3: –ö–ª–∞—Å—Å PhoenixSearch</h2>
            </div>
            <p>–ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞–±–æ—Ç—É –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –∫–ª–∞—Å—Å–∞ –ø–æ–∏—Å–∫–∞</p>
            <button onclick="testPhoenixClass()">–ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç</button>
            <div id="result3" class="result">–ù–∞–∂–º–∏ –∫–Ω–æ–ø–∫—É –¥–ª—è —Ç–µ—Å—Ç–∞...</div>
        </div>
        
        <!-- –¢–ï–°–¢ 4: –ü–û–õ–ù–´–ô –ü–û–¢–û–ö -->
        <div class="test-section">
            <div class="test-header">
                <div class="test-icon">üöÄ</div>
                <h2>–¢–µ—Å—Ç 4: –ü–æ–ª–Ω—ã–π —Ä–∞–±–æ—á–∏–π –ø–æ—Ç–æ–∫</h2>
            </div>
            <p>–ò–º–∏—Ç–∞—Ü–∏—è —Ä–µ–∞–ª—å–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã</p>
            <button onclick="testFullFlow()">–ó–∞–ø—É—Å—Ç–∏—Ç—å –ø–æ–ª–Ω—ã–π —Ç–µ—Å—Ç</button>
            <div id="result4" class="result">–ù–∞–∂–º–∏ –∫–Ω–æ–ø–∫—É –¥–ª—è —Ç–µ—Å—Ç–∞...</div>
        </div>
        
        <!-- –°–¢–ê–¢–£–° -->
        <div class="test-section">
            <div class="test-header">
                <div class="test-icon">üìä</div>
                <h2>–û–±—â–∏–π —Å—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã</h2>
            </div>
            <div id="status">–ì–æ—Ç–æ–≤ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é...</div>
            <button onclick="runAllTests()" style="background:linear-gradient(45deg,#9b59b6,#8e44ad);">
                üèÉ –ó–ê–ü–£–°–¢–ò–¢–¨ –í–°–ï –¢–ï–°–¢–´
            </button>
        </div>
    </div>
    
    <script>
    // –§—É–Ω–∫—Ü–∏–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
    
    async function testSearchAPI() {
        const resultDiv = document.getElementById('result1');
        resultDiv.innerHTML = '<span class="loading">üîÑ –¢–µ—Å—Ç–∏—Ä—É—é API –ø–æ–∏—Å–∫–∞...</span>';
        
        try {
            const response = await fetch('https://phoenix-search-prototype.vercel.app/api/search', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({
                    query: '–ö–∞–∫ –Ω–∞–π—Ç–∏ —Å–≤–æ—ë –ø—Ä–∏–∑–≤–∞–Ω–∏–µ?',
                    sessionId: 'test-' + Date.now()
                })
            });
            
            const data = await response.json();
            
            if (data.success) {
                resultDiv.innerHTML = `
                    <div class="success">
                        ‚úÖ API –ü–û–ò–°–ö–ê –†–ê–ë–û–¢–ê–ï–¢<br><br>
                        <strong>–°—Ç–∞—Ç—É—Å:</strong> ${response.status} OK<br>
                        <strong>–ò—Å—Ç–æ—á–Ω–∏–∫:</strong> ${data.source || '–Ω–µ —É–∫–∞–∑–∞–Ω'}<br>
                        <strong>–ö–æ–ª–ª–µ–∫—Ç–∏–≤–Ω–∞—è –º—É–¥—Ä–æ—Å—Ç—å:</strong> ${data.collective?.peopleCount || 0}+ —á–µ–ª–æ–≤–µ–∫<br>
                        <strong>–¢–∏–ø –æ—Ç–≤–µ—Ç–∞:</strong> ${data.response?.type || '–Ω–µ —É–∫–∞–∑–∞–Ω'}<br><br>
                        <strong>–°—É—Ç—å:</strong> ${data.response?.essence?.substring(0, 100)}...
                    </div>
                `;
                return true;
            } else {
                resultDiv.innerHTML = `
                    <div class="error">
                        ‚ùå API –≤–µ—Ä–Ω—É–ª –æ—à–∏–±–∫—É<br><br>
                        <strong>–°—Ç–∞—Ç—É—Å:</strong> ${response.status}<br>
                        <strong>–û—à–∏–±–∫–∞:</strong> ${data.error || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞'}
                    </div>
                `;
                return false;
            }
        } catch (error) {
            resultDiv.innerHTML = `
                <div class="error">
                    ‚ùå –û–®–ò–ë–ö–ê –°–û–ï–î–ò–ù–ï–ù–ò–Ø<br><br>
                    <strong>–°–æ–æ–±—â–µ–Ω–∏–µ:</strong> ${error.message}<br>
                    <strong>–ü—Ä–æ–≤–µ—Ä—å:</strong> 
                    <ol>
                        <li>–ò–Ω—Ç–µ—Ä–Ω–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ</li>
                        <li>URL API: phoenix-search-prototype.vercel.app</li>
                        <li>CORS –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ api/search.js</li>
                    </ol>
                </div>
            `;
            return false;
        }
    }
    
    async function testQuestionsAPI() {
        const resultDiv = document.getElementById('result2');
        resultDiv.innerHTML = '<span class="loading">üîÑ –¢–µ—Å—Ç–∏—Ä—É—é API –≤–æ–ø—Ä–æ—Å–æ–≤...</span>';
        
        try {
            const response = await fetch('https://phoenix-search-prototype.vercel.app/api/questions?query=–ø—Ä–∏–∑–≤–∞–Ω–∏–µ&limit=3');
            const data = await response.json();
            
            if (response.ok) {
                resultDiv.innerHTML = `
                    <div class="success">
                        ‚úÖ API –í–û–ü–†–û–°–û–í –†–ê–ë–û–¢–ê–ï–¢<br><br>
                        <strong>–°—Ç–∞—Ç—É—Å:</strong> ${response.status} OK<br>
                        <strong>–¢–∏–ø:</strong> ${data.type || '–Ω–µ —É–∫–∞–∑–∞–Ω'}<br>
                        <strong>–ù–∞–π–¥–µ–Ω–æ –≤–æ–ø—Ä–æ—Å–æ–≤:</strong> ${data.count || data.questions?.length || 0}<br><br>
                        <strong>–ö–æ–ª–ª–µ–∫—Ç–∏–≤–Ω–∞—è –º—É–¥—Ä–æ—Å—Ç—å:</strong><br>
                        ${data.wisdom?.message || '–î–∞–Ω–Ω—ã–µ –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã'}
                    </div>
                `;
                return true;
            } else {
                resultDivDiv.innerHTML = `<div class="error">‚ùå –û—à–∏–±–∫–∞: ${response.status}</div>`;
                return false;
            }
        } catch (error) {
            resultDiv.innerHTML = `<div class="error">‚ùå –û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è: ${error.message}</div>`;
            return false;
        }
    }
    
    async function testPhoenixClass() {
        const resultDiv = document.getElementById('result3');
        resultDiv.innerHTML = '<span class="loading">üîÑ –¢–µ—Å—Ç–∏—Ä—É—é –∫–ª–∞—Å—Å PhoenixSearch...</span>';
        
        try {
            // –ó–∞–≥—Ä—É–∂–∞–µ–º phoenix.js –µ—Å–ª–∏ –µ—â—ë –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω
            if (typeof PhoenixSearch === 'undefined') {
                const script = document.createElement('script');
                script.src = 'https://phoenix-time-inc.github.io/phoenix-search-prototype/phoenix.js';
                document.head.appendChild(script);
                
                // –ñ–¥—ë–º –∑–∞–≥—Ä—É–∑–∫–∏
                await new Promise(resolve => setTimeout(resolve, 2000));
                
                if (typeof PhoenixSearch === 'undefined') {
                    throw new Error('–ö–ª–∞—Å—Å PhoenixSearch –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª—Å—è');
                }
            }
            
            // –°–æ–∑–¥–∞—ë–º —ç–∫–∑–µ–º–ø–ª—è—Ä –∏ —Ç–µ—Å—Ç–∏—Ä—É–µ–º
            const phoenix = new PhoenixSearch();
            const response = await phoenix.search('–¢–µ—Å—Ç –∫–æ–ª–ª–µ–∫—Ç–∏–≤–Ω–æ–π –º—É–¥—Ä–æ—Å—Ç–∏');
            
            resultDiv.innerHTML = `
                <div class="success">
                    ‚úÖ –ö–õ–ê–°–° PhoenixSearch –†–ê–ë–û–¢–ê–ï–¢<br><br>
                    <strong>ID —Å–µ—Å—Å–∏–∏:</strong> ${phoenix.sessionId}<br>
                    <strong>–¢–∏–ø –æ—Ç–≤–µ—Ç–∞:</strong> ${response.type}<br>
                    <strong>–ö–æ–ª–ª–µ–∫—Ç–∏–≤–Ω–∞—è –º—É–¥—Ä–æ—Å—Ç—å:</strong> ${response.collective?.peopleCount || 0}+ —á–µ–ª–æ–≤–µ–∫<br><br>
                    <strong>–°—É—Ç—å:</strong> ${response.essence?.substring(0, 80)}...<br><br>
                    <strong>–†–µ–∑–æ–Ω–∞–Ω—Å:</strong> ${response.resonance?.substring(0, 60)}...
                </div>
            `;
            return true;
            
        } catch (error) {
            resultDiv.innerHTML = `
                <div class="error">
                    ‚ùå –û–®–ò–ë–ö–ê –ö–õ–ê–°–°–ê<br><br>
                    <strong>–°–æ–æ–±—â–µ–Ω–∏–µ:</strong> ${error.message}<br>
                    <strong>–ü—Ä–æ–≤–µ—Ä—å:</strong>
                    <ol>
                        <li>–§–∞–π–ª phoenix.js –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ —Å—Å—ã–ª–∫–µ</li>
                        <li>–í –∫–æ–¥–µ –µ—Å—Ç—å –∫–ª–∞—Å—Å PhoenixSearch</li>
                        <li>–ù–µ—Ç –æ—à–∏–±–æ–∫ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞ –≤ –∫–æ–Ω—Å–æ–ª–∏</li>
                    </ol>
                </div>
            `;
            return false;
        }
    }
    
    async function testFullFlow() {
        const resultDiv = document.getElementById('result4');
        resultDiv.innerHTML = '<span class="loading">üîÑ –ó–∞–ø—É—Å–∫–∞—é –ø–æ–ª–Ω—ã–π —Ç–µ—Å—Ç...</span>';
        
        let logs = 'üöÄ –ó–ê–ü–£–°–ö –ü–û–õ–ù–û–ì–û –¢–ï–°–¢–ê\n' + '='.repeat(50) + '\n\n';
        
        try {
            // 1. –¢–µ—Å—Ç API –ø–æ–∏—Å–∫–∞
            logs += '1. üîç –¢–ï–°–¢ API –ü–û–ò–°–ö–ê:\n';
            const searchTest = await testSearchAPI();
            logs += searchTest ? '   ‚úÖ –ü–†–û–ô–î–ï–ù\n\n' : '   ‚ùå –ü–†–û–í–ê–õ–ï–ù\n\n';
            
            // 2. –¢–µ—Å—Ç –∫–ª–∞—Å—Å–∞ PhoenixSearch
            logs += '2. ü¶Ö –¢–ï–°–¢ –ö–õ–ê–°–°–ê PhoenixSearch:\n';
            const classTest = await testPhoenixClass();
            logs += classTest ? '   ‚úÖ –ü–†–û–ô–î–ï–ù\n\n' : '   ‚ùå –ü–†–û–í–ê–õ–ï–ù\n\n';
            
            // 3. –ò–º–∏—Ç–∞—Ü–∏—è —Ä–µ–∞–ª—å–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
            logs += '3. üë§ –ò–ú–ò–¢–ê–¶–ò–Ø –†–ï–ê–õ–¨–ù–û–ì–û –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Ø:\n';
            if (typeof PhoenixSearch !== 'undefined') {
                const phoenix = new PhoenixSearch();
                
                // 3 –∑–∞–ø—Ä–æ—Å–∞
                const questions = [
                    '–ö–∞–∫ –Ω–∞–π—Ç–∏ —Å–≤–æ–π –ø—É—Ç—å?',
                    '–ü–æ—á–µ–º—É —è –ø—Ä–æ–∫—Ä–∞—Å—Ç–∏–Ω–∏—Ä—É—é?',
                    '–í —á—ë–º —Å–º—ã—Å–ª –∂–∏–∑–Ω–∏?'
                ];
                
                for (let i = 0; i < questions.length; i++) {
                    logs += `   ${i+1}. "${questions[i]}"\n`;
                    try {
                        const response = await phoenix.search(questions[i]);
                        logs += `      ‚Üí ${response.type}: ${response.collective?.peopleCount || 0}+ –ª—é–¥–µ–π –∏—Å–∫–∞–ª–∏\n`;
                    } catch (e) {
                        logs += `      ‚Üí ‚ùå –û—à–∏–±–∫–∞: ${e.message}\n`;
                    }
                    await new Promise(resolve => setTimeout(resolve, 500));
                }
                logs += '   ‚úÖ –í–°–ï –ó–ê–ü–†–û–°–´ –û–ë–†–ê–ë–û–¢–ê–ù–´\n\n';
            }
            
            // –ò—Ç–æ–≥
            const successCount = [searchTest, classTest].filter(Boolean).length;
            logs += '='.repeat(50) + '\n';
            logs += `üìä –ò–¢–û–ì: ${successCount}/2 —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ–π–¥–µ–Ω–æ\n`;
            logs += successCount === 2 ? 'üéâ –°–ò–°–¢–ï–ú–ê –ì–û–¢–û–í–ê –ö –†–ê–ë–û–¢–ï!' : '‚ö†Ô∏è –¢–†–ï–ë–£–ï–¢–°–Ø –î–û–†–ê–ë–û–¢–ö–ê';
            
            resultDiv.innerHTML = `<div class="${successCount === 2 ? 'success' : 'error'}">${logs}</div>`;
            
        } catch (error) {
            resultDiv.innerHTML = `<div class="error">‚ùå –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –û–®–ò–ë–ö–ê: ${error.message}</div>`;
        }
    }
    
    async function runAllTests() {
        document.getElementById('status').innerHTML = 'üîÑ –ó–∞–ø—É—Å–∫–∞—é –≤—Å–µ —Ç–µ—Å—Ç—ã...';
        
        const results = await Promise.allSettled([
            testSearchAPI(),
            testQuestionsAPI(),
            testPhoenixClass()
        ]);
        
        const passed = results.filter(r => r.status === 'fulfilled' && r.value === true).length;
        const total = results.length;
        
        document.getElementById('status').innerHTML = `
            üìä –†–ï–ó–£–õ–¨–¢–ê–¢–´ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Ø:<br>
            ‚úÖ –ü—Ä–æ–π–¥–µ–Ω–æ: ${passed} –∏–∑ ${total} —Ç–µ—Å—Ç–æ–≤<br>
            ${passed === total ? 'üéâ –í–°–ï –°–ò–°–¢–ï–ú–´ –†–ê–ë–û–¢–ê–Æ–¢!' : '‚ö†Ô∏è –¢–†–ï–ë–£–ï–¢–°–Ø –ü–†–û–í–ï–†–ö–ê'}
        `;
    }
    
    // –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
    document.addEventListener('DOMContentLoaded', () => {
        console.log('üß™ –¢–µ—Å—Ç–æ–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞');
        console.log('API URL:', 'https://phoenix-search-prototype.vercel.app');
        console.log('GitHub Pages:', 'https://phoenix-time-inc.github.io/phoenix-search-prototype/');
    });
    </script>
</body>
</html>
